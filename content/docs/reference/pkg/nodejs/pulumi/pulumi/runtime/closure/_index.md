---
title: "Module runtime/closure"
title_tag: "Module runtime/closure | Package @pulumi/pulumi | Node.js SDK"
linktitle: "closure"
meta_desc: "Explore members of the closure module in the @pulumi/pulumi package."
git_sha: "b5b0fa01365a4e43679c602162a91211c1be8768"
---

<!-- WARNING: this page was generated by a tool. Do not edit it by hand. -->
<!-- To change it, please see https://github.com/pulumi/docs/tree/master/tools/tscdocgen. -->






<h3>APIs</h3>
<ul class="api">
    <li><a href="#CodePathOptions"><span class="symbol api"></span>CodePathOptions</a></li>
    <li><a href="#computeCodePaths"><span class="symbol api"></span>computeCodePaths</a></li>
    <li><a href="#SerializedFunction"><span class="symbol api"></span>SerializedFunction</a></li>
    <li><a href="#serializeFunction"><span class="symbol api"></span>serializeFunction</a></li>
    <li><a href="#SerializeFunctionArgs"><span class="symbol api"></span>SerializeFunctionArgs</a></li>
    <li><a href="#serializeFunctionAsync"><span class="symbol api"></span>serializeFunctionAsync</a></li>
</ul>




<h2 id="apis">APIs</h2>
<h3 class="pdoc-module-header" id="CodePathOptions" data-link-title="CodePathOptions">
    <a href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/codePaths.ts#L29">
        interface <strong>CodePathOptions</strong>
    </a>
</h3>

<pre class="highlight"><code><span class='kr'>interface</span> <span class='nx'>CodePathOptions</span></code></pre>

Options for controlling what gets returned by [computeCodePaths].

<h4 class="pdoc-member-header" id="CodePathOptions-extraExcludePackages">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/codePaths.ts#L50">property <b>extraExcludePackages</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>extraExcludePackages?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>[];</code></pre>

Packages to explicitly exclude from the Assets for a serialized closure.  This can be used
when clients want to trim down the size of a closure, and they know that some package won't
ever actually be needed at runtime, but is still a dependency of some package that is being
used at runtime.

<h4 class="pdoc-member-header" id="CodePathOptions-extraIncludePackages">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/codePaths.ts#L42">property <b>extraIncludePackages</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>extraIncludePackages?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>[];</code></pre>

Extra packages to include when producing the Assets for a serialized closure.  This can be
useful if the packages are acquired in a way that the serialization code does not understand.
For example, if there was some sort of module that was pulled in based off of a computed
string.

<h4 class="pdoc-member-header" id="CodePathOptions-extraIncludePaths">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/codePaths.ts#L34">property <b>extraIncludePaths</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>extraIncludePaths?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>[];</code></pre>

Local file/directory paths that we always want to include when producing the Assets to be
included for a serialized closure.

<h4 class="pdoc-member-header" id="CodePathOptions-logResource">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/codePaths.ts#L55">property <b>logResource</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>logResource?: <a href='/docs/reference/pkg/nodejs/pulumi/pulumi/#Resource'>Resource</a>;</code></pre>

The resource to log any errors we encounter against.

<h3 class="pdoc-module-header" id="computeCodePaths" data-link-title="computeCodePaths">
    <a href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/codePaths.ts#L78">
        function <strong>computeCodePaths</strong>
    </a>
</h3>


<pre class="highlight"><code><span class='kd'></span>computeCodePaths(options?: <a href='#CodePathOptions'>CodePathOptions</a>): <a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise'>Promise</a>&lt;<a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map'>Map</a>&lt;<span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>, <a href='/docs/reference/pkg/nodejs/pulumi/pulumi/asset/#Asset'>Asset</a> | <a href='/docs/reference/pkg/nodejs/pulumi/pulumi/asset/#Archive'>Archive</a>&gt;&gt;</code></pre>


computeCodePaths computes the local node_module paths to include in an uploaded cloud 'Lambda'.
Specifically, it will examine the package.json for the caller's code, and will transitively walk
it's 'dependencies' section to determine what packages should be included.

During this walk, if a package is encountered that contains a `"pulumi": { ... }` section then
the normal `"dependencies": { ... }` section of that package will not be included.  These are
"pulumi" packages, and those dependencies are only intended for use at deployment time. However,
a "pulumi" package can also specify package that should be available at cloud-runtime.  These
packages are found in a `"runtimeDependencies": { ... }` section in the package.json file with
the same format as the normal "dependencies" section.

See [CodePathOptions] for information on ways to control and configure the final set of paths
included in the resultant asset/archive map.

Note: this functionality is specifically intended for use by downstream library code that is
determining what is needed for a cloud-lambda.  i.e. the aws.serverless.Function or
azure.serverless.FunctionApp libraries.  In general, other clients should not need to use this
helper.


<div class="note note-deprecated">
<i class="fas fa-exclamation-triangle pr-2"></i><strong>DEPRECATED</strong>
Use the [computeCodePaths] overload that takes a [CodePathOptions] instead.
</div>
<pre class="highlight"><code><span class='kd'></span>computeCodePaths(extraIncludePaths?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>[], extraIncludePackages?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>[], extraExcludePackages?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>[]): <a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise'>Promise</a>&lt;<a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map'>Map</a>&lt;<span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>, <a href='/docs/reference/pkg/nodejs/pulumi/pulumi/asset/#Asset'>Asset</a> | <a href='/docs/reference/pkg/nodejs/pulumi/pulumi/asset/#Archive'>Archive</a>&gt;&gt;</code></pre>

<h3 class="pdoc-module-header" id="SerializedFunction" data-link-title="SerializedFunction">
    <a href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L55">
        interface <strong>SerializedFunction</strong>
    </a>
</h3>

<pre class="highlight"><code><span class='kr'>interface</span> <span class='nx'>SerializedFunction</span></code></pre>

SerializeFunction is a representation of a serialized JavaScript function.

<h4 class="pdoc-member-header" id="SerializedFunction-exportName">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L65">property <b>exportName</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>exportName: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>;</code></pre>

The name of the exported module member.

<h4 class="pdoc-member-header" id="SerializedFunction-text">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L61">property <b>text</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>text: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>;</code></pre>

The text of a JavaScript module which exports a single name bound to an appropriate value.
In the case of a normal function, this value will just be serialized function.  In the case
of a factory function this value will be the result of invoking the factory function.

<h3 class="pdoc-module-header" id="serializeFunction" data-link-title="serializeFunction">
    <a href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L85">
        function <strong>serializeFunction</strong>
    </a>
</h3>


<pre class="highlight"><code><span class='kd'></span>serializeFunction(func: Function, args: <a href='#SerializeFunctionArgs'>SerializeFunctionArgs</a>): <a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise'>Promise</a>&lt;<a href='#SerializedFunction'>SerializedFunction</a>&gt;</code></pre>


serializeFunction serializes a JavaScript function into a text form that can be loaded in another execution context,
for example as part of a function callback associated with an AWS Lambda.  The function serialization captures any
variables captured by the function body and serializes those values into the generated text along with the function
body.  This process is recursive, so that functions referenced by the body of the serialized function will themselves
be serialized as well.  This process also deeply serializes captured object values, including prototype chains and
property descriptors, such that the semantics of the function when deserialized should match the original function.

There are several known limitations:
- If a native function is captured either directly or indirectly, closure serialization will return an error.
- Captured values will be serialized based on their values at the time that `serializeFunction` is called.  Mutations
  to these values after that (but before the deserialized function is used) will not be observed by the deserialized
  function.

<h3 class="pdoc-module-header" id="SerializeFunctionArgs" data-link-title="SerializeFunctionArgs">
    <a href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L23">
        interface <strong>SerializeFunctionArgs</strong>
    </a>
</h3>

<pre class="highlight"><code><span class='kr'>interface</span> <span class='nx'>SerializeFunctionArgs</span></code></pre>

SerializeFunctionArgs are arguments used to serialize a JavaScript function

<h4 class="pdoc-member-header" id="SerializeFunctionArgs-exportName">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L27">property <b>exportName</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>exportName?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined'>undefined</a></span> | <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>;</code></pre>

The name to export from the module defined by the generated module text.  Defaults to 'handler'.

<h4 class="pdoc-member-header" id="SerializeFunctionArgs-isFactoryFunction">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L44">property <b>isFactoryFunction</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>isFactoryFunction?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined'>undefined</a></span> | <span class='kd'>false</span> | <span class='kd'>true</span>;</code></pre>

If this is a function which, when invoked, will produce the actual entrypoint function.
Useful for when serializing a function that has high startup cost that only wants to be
run once. The signature of this function should be:  () => (provider_handler_args...) => provider_result

This will then be emitted as: `exports.[exportName] = serialized_func_name();`

In other words, the function will be invoked (once) and the resulting inner function will
be what is exported.

<h4 class="pdoc-member-header" id="SerializeFunctionArgs-logResource">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L49">property <b>logResource</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>logResource?: <a href='/docs/reference/pkg/nodejs/pulumi/pulumi/#Resource'>Resource</a>;</code></pre>

The resource to log any errors we encounter against.

<h4 class="pdoc-member-header" id="SerializeFunctionArgs-serialize">
<a class="pdoc-child-name" href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L32">property <b>serialize</b></a>
</h4>

<pre class="highlight"><code><span class='kd'></span>serialize?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined'>undefined</a></span> | (o: <span class='kd'><a href='https://www.typescriptlang.org/docs/handbook/basic-types.html#any'>any</a></span>) => <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean'>boolean</a></span>;</code></pre>

A function to prevent serialization of certain objects captured during the serialization.  Primarily used to
prevent potential cycles.

<h3 class="pdoc-module-header" id="serializeFunctionAsync" data-link-title="serializeFunctionAsync">
    <a href="https://github.com/pulumi/pulumi/blob/{{< param git_sha >}}/sdk/nodejs/runtime/closure/serializeClosure.ts#L100">
        function <strong>serializeFunctionAsync</strong>
    </a>
</h3>


<div class="note note-deprecated">
<i class="fas fa-exclamation-triangle pr-2"></i><strong>DEPRECATED</strong>
Please use &#39;serializeFunction&#39; instead.
</div>
<pre class="highlight"><code><span class='kd'></span>serializeFunctionAsync(func: Function, serialize?: <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined'>undefined</a></span> | (o: <span class='kd'><a href='https://www.typescriptlang.org/docs/handbook/basic-types.html#any'>any</a></span>) => <span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean'>boolean</a></span>): <a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise'>Promise</a>&lt;<span class='kd'><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String'>string</a></span>&gt;</code></pre>

