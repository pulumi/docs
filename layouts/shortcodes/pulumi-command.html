{{/* Fetch the current version of the Pulumi CLI doc." suffix. */}}
{{ $headers := dict }}
{{ with (os.Getenv "GITHUB_TOKEN") }}
    {{ $token := printf "Bearer %s" . }}
    {{ $headers = (dict "Authorization" $token) }}
{{ end }}

{{- $json := resources.GetRemote "https://api.github.com/repos/pulumi/docs/contents/content/docs/iac/cli/commands/pulumi.md" $headers }}
{{ with $json }}
    {{ $data := . | transform.Unmarshal }}
    {{ $content := base64Decode $data.content }}
    {{/* Remove front matter and "Auto generated by..." suffix. */}}
    {{- $content = replaceRE "(?s)---.*---" "" $content -}}
    {{- $content = replaceRE "(?m)^###### Auto generated by .*$" "" $content -}}
    {{- markdownify $content -}}
{{ end }}
