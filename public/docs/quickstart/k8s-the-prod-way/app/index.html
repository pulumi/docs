<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
    <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="google-site-verification" content="j-Opn93zR4YQcV5bbYN99BmNc48BT5mzd2VpzKaW9YY" />

    

    
    <meta property="og:type" content="article">
    <meta property="og:url" content="/docs/quickstart/k8s-the-prod-way/app/">
    <meta property="og:site_name" content="pulumi">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@PulumiCorp">

    

    
        <meta property="og:title" content="Provisioning a Kubernetes Application">
    

    
        <meta name="description" content="This lab assumes you have successfully completed lab 1, and lab 2 the results of which are to have (1) successfully bootstrapped the identity platform for CI/CD and teams, and (2) successfully created the Kubernetes cluster on which we will deploy.
In this tutorial, we will use this identity to:
 Use the identity provisioned in lab 1 and the Kubernetes cluster provisioned in lab 2 to provision a Kubernetes app, Wordpress.">
        <meta property="og:description" content="This lab assumes you have successfully completed lab 1, and lab 2 the results of which are to have (1) successfully bootstrapped the identity platform for CI/CD and teams, and (2) successfully created the Kubernetes cluster on which we will deploy.
In this tutorial, we will use this identity to:
 Use the identity provisioned in lab 1 and the Kubernetes cluster provisioned in lab 2 to provision a Kubernetes app, Wordpress.">
    

    
    
    <meta property="og:image" content="/social/pulumi.png">

    <title>Provisioning a Kubernetes Application - Pulumi</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico" />

    
    <link rel="canonical" href="https://www.pulumi.com/docs/quickstart/k8s-the-prod-way/app/" >

    
    <link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Pulumi Blog" />

    
    
    
        
        
        
        <link rel="stylesheet" href="/css/styles.3496f5522ba2ee3f8bbb9a51ff2cb20fb6827ca85a8ae61de0a9f960bacf1023.css" integrity="sha256-NJb1Uiui7j&#43;Lu5pR/yyyD7aCfKhaiuYd4Kn5YLrPECM=">
    

    <script async defer src="https://buttons.github.io/buttons.js"></script>

    
    
        <script src="//cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function(event) {
                anchors.add("h1:not(.no-anchor), h2:not(.no-anchor), h3:not(.no-anchor), h4:not(.no-anchor), h5:not(.no-anchor), h6:not(.no-anchor)");
            });
        </script>
    

    
    
</head>

    <body class="section-docs">
        <nav class="bg-black text-white text-sm py-2 px-4 lg:px-0 transition-all max-h-screen md:max-h-full">
    <div class="container mx-auto">
        <ul class="flex justify-end items-center h-6">
            <li class="mr-8"><a href="https://slack.pulumi.io/" target="_blank">Slack</a></li>
            <li class="mr-8"><a href="https://github.com/pulumi" target="_blank">GitHub</a></li>
            <li class="mr-8"><a href="https://app.pulumi.com/" target="_blank">Console</a></li>
            <li class="github-widget">
                <a class="github-button" href="https://github.com/pulumi/pulumi" data-size="small" data-show-count="true" aria-label="Star pulumi/pulumi on GitHub">Star</a>
            </li>
        </ul>
    </div>
</nav>



<nav class="nav-main bg-purple-700 py-6 px-4 lg:px-0 border-t border-purple-500">
    <div class="container mx-auto">
        <header class="flex items-center justify-between flex-wrap md:flex-no-wrap">
            <div class="flex items-center flex-shrink-0 text-white lg:mr-6">
                <a class="block" href="/">
                    <img class="h-10 block" src="/images/logo/logo-inv.svg" alt="Pulumi logo">
                </a>
            </div>

            <div class="nav-header-toggle block md:hidden">
                <button class="flex items-center px-3 py-2 border rounded text-white border-purple-400 bg-purple-600">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <ul class="nav-header-items hidden w-full flex-grow md:flex md:items-center md:w-auto text-white text-sm md:text-xs lg:text-sm uppercase pt-4 md:pt-0">
                
                    <li class="whitespace-no-wrap">
                        
                        <a href="/product/" data-submenu="product" class="block py-2 px-4 md:px-0 md:py-0 md:px-4 md:py-2 my-2 md:my-0 lg:mx-4 rounded hover:bg-purple-500">
                            Products
                        </a>
                    </li>
                
                    <li class="whitespace-no-wrap">
                        
                        <a href="/why-pulumi/" data-submenu="why" class="block py-2 px-4 md:px-0 md:py-0 md:px-4 md:py-2 my-2 md:my-0 lg:mx-4 rounded hover:bg-purple-500">
                            Why Pulumi
                        </a>
                    </li>
                
                    <li class="whitespace-no-wrap">
                        
                        <a href="/pricing/" data-submenu="" class="block py-2 px-4 md:px-0 md:py-0 md:px-4 md:py-2 my-2 md:my-0 lg:mx-4 rounded hover:bg-purple-500">
                            Pricing
                        </a>
                    </li>
                
                    <li class="whitespace-no-wrap">
                        
                        <a href="/docs/" data-submenu="" class="block py-2 px-4 md:px-0 md:py-0 md:px-4 md:py-2 my-2 md:my-0 lg:mx-4 rounded bg-purple-400 hover:bg-purple-400">
                            Docs
                        </a>
                    </li>
                
                    <li class="whitespace-no-wrap">
                        
                        <a href="/blog/" data-submenu="" class="block py-2 px-4 md:px-0 md:py-0 md:px-4 md:py-2 my-2 md:my-0 lg:mx-4 rounded hover:bg-purple-500">
                            Blog
                        </a>
                    </li>
                
                    <li class="whitespace-no-wrap">
                        
                        <a href="/about/" data-submenu="about" class="block py-2 px-4 md:px-0 md:py-0 md:px-4 md:py-2 my-2 md:my-0 lg:mx-4 rounded hover:bg-purple-500">
                            About
                        </a>
                    </li>
                

                <li class="md:ml-auto md:mr-2 lg:mr-4">
                    <a class="block mt-4 md:mt-0 md:text-xs lg:text-sm btn btn-orange-translucent" href="https://app.pulumi.com/">Sign In</a>
                </li>
                <li>
                    <a class="block mt-4 md:mt-0 md:text-xs lg:text-sm btn" href="https://app.pulumi.com/signup">Sign Up</a>
                </li>
            </ul>
        </header>
    </div>
</nav>
<div class="submenu">
    <div class="text-white relative overflow-visible">
        <div class="submenu-item submenu-item-product hidden absolute inset-x-0 z-50 bg-purple-700 shadow-lg pt-8 pb-16">
            <div class="container mx-auto flex items-start">
                <div class="w-1/2 pr-12 border-r border-purple-500 text-purple-100 text-sm">
                    <h3 class="text-white">The Pulumi Platform</h3>
                    <p class="text-white">
                        Cloud Apps and Infrastructure for any cloud using languages you already know and love.
                    </p>
                    <ul class="p-0 leading-loose">
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400" href="/product/#pulumi-sdk">Pulumi SDK</a>
                            <span>&rarr; Cloud native infrastructure as code.</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400" href="/product/#pulumi-crosswalk">Pulumi Crosswalk</a>
                            <span>&rarr; Productive infrastructure as code with built-in best practices.</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400" href="/product/#pulumi-saas">Pulumi SaaS</a>
                            <span>&rarr; Continuously deliver and manage cloud software for any cloud.</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400" href="/product/#multi-cloud-subscription">Multi-Cloud Subscription</a>
                            <span>&rarr; End-to-end Kubernetes solutions to achieve multi-cloud.</span>
                        </li>
                    </ul>
                    <p>
                        <span class="text-white">Pulumi is open source, free to start, and has plans available for teams.</span>
                        <a class="text-orange-500 hover:text-orange-400 hover:mr-1 transition-all" href="/pricing/">View Pricing</a> &rarr;
                    </p>
                </div>
                <div class="w-1/2 pl-12 text-purple-100 text-sm">
                    <h3 class="text-white">Get Started</h3>
                    <ul class="p-0 leading-loose">
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/docs/reference/install/">Install (Mac, Windows, Linux)</a> &rarr;
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/docs/">Documentation and Examples</a> &rarr;
                        </li>
                    </ul>
                    <h3 class="text-white">Migrate to Pulumi</h3>
                    <ul class="p-0 leading-loose">
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/cloudformation/">from CloudFormation</a> &rarr;
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/terraform/">from Terraform</a> &rarr;
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="submenu-item submenu-item-why hidden absolute inset-x-0 z-50 bg-purple-700 shadow pt-8 pb-16">
           <div class="container mx-auto flex items-start">
                <div class="w-1/2 pr-12 border-r border-purple-500 text-purple-100 text-sm">
                    <h3 class="text-white">Solutions for All Teams and Engineers</h3>
                    <p class="text-white">
                        Maximize cloud velocity for Dev, DevOps, and IT, no matter your team size.
                    </p>
                    <ul class="p-0 leading-loose">
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400" href="/why-pulumi/#for-developers">For Developers</a>
                            <span>&rarr; Your favorite languages, tools, and libraries.</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400" href="/why-pulumi/#for-operators">For DevOps and IT</a>
                            <span>&rarr; Empower your team to deliver to many clouds.</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400" href="/why-pulumi/#for-business-leaders">For Business Leaders</a>
                            <span>&rarr; Modern multi-cloud for startups and enterprises.</span>
                        </li>
                    </ul>
                </div>
                <div class="w-1/4 px-12 border-r border-purple-500 text-purple-100 text-sm">
                    <h3 class="text-white">Any Code</h3>
                    <ul class="p-0 leading-loose">
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/serverless/">Serverless</a>
                            <span>&rarr;</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/containers/">Containers</a>
                            <span>&rarr;</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/kubernetes/">Kubernetes</a>
                            <span>&rarr;</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/docs/reference/tutorials/aws/tutorial-ec2-webserver/">Infrastructure</a>
                            <span>&rarr;</span>
                        </li>
                    </ul>
                </div>
                <div class="w-1/4 pl-12 text-purple-100 text-sm">
                    <h3 class="text-white">Migrate to Pulumi</h3>
                    <ul class="p-0 leading-loose">
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/aws/">AWS</a>
                            <span>&rarr;</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/azure/">Azure</a>
                            <span>&rarr;</span>
                        </li>
                        <li>
                            <a class="text-orange-500 font-bold hover:text-orange-400 hover:mr-1 transition-all" href="/gcp/">GCP</a>
                            <span>&rarr;</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>


        
        

        <main>
            
    <div class="container mx-auto px-8 py-8 md:px-0">
        <div class="md:flex">

            <div class="md:w-2/12 mt-2 md:order-last">
                <div class="mb-8 md:mb-4">
                    <form class="relative" action="/docs/search/" method="GET">
    <i class="fas fa-search absolute inset-y-0 flex items-center pl-3 text-gray-500"></i>
    <input
        id="search-query"
        name="q"
        class="block w-full py-2 px-4 pl-8 text-sm border border-gray-400 focus:border-blue-500 focus:outline-none rounded transition"
        placeholder="Search the docs"
        autocomplete="off">
</form>

                </div>

                <div class="ml-3 hidden md:block">
                    
    <ul class="p-0 list-none">
        
        
        
        
        
            <li>
                <a class="text-gray-600 hover:text-blue-700 text-xs" href="https://github.com/pulumi/docs/edit/master/content/docs/quickstart/k8s-the-prod-way/app.md" target="_blank">
                    <i class="fas fa-edit mr-2"></i>
                    Edit this Page
                </a>
            </li>
        

        <li>
            <a class="text-gray-600 hover:text-blue-700 text-xs" href="https://github.com/pulumi/docs/issues/new?body=File: [docs%2fquickstart%2fk8s-the-prod-way%2fapp.md](%2fdocs%2fquickstart%2fk8s-the-prod-way%2fapp%2f)" target="_blank">
                <i class="far fa-check-square mr-2"></i>
                Request a Change
            </a>
        </li>
    </ul>


                </div>
            </div>

            <div class="md:w-3/12 pr-8 mt-2 mb-8 pb-8 border-b-2 border-gray-400 md:border-none md:pb-0 md:mb-0">
                








    
    
    


<aside class="toc">
    <h3 class="no-anchor">
        <a href="/docs/">Docs</a>
    </h3>

    
        <h4 class="no-anchor">
            <a href="/docs/quickstart/">Get Started</a>
        </h4>
    
    
    

    
        
        

        
            
            

            

            <div class="toggleVisible separator">
                <div class="toggle" data-title="AWS">
                    <div class="collapsed">
                        <div class="sidenav-topic ">
                            <a data-title="AWS" href="/docs/quickstart/aws/">AWS</a><span class="toggleButton">
                                    <i class="fas fa-caret-right"></i>
                                </span></div>
                    </div>
                    <div class="expanded">
                        <div class="sidenav-topic  sidenav-parent  ">
                            <a data-title="AWS" href="/docs/quickstart/aws/">AWS</a><span class="toggleButton">
                                    <i class="fas fa-caret-down"></i>
                                </span></div>
                        
                            <div class="sidenav-subsection text-sm">
                                
    
    

    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Install Pulumi" href="/docs/quickstart/aws/install-pulumi/">Install Pulumi</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Install Language Runtime" href="/docs/quickstart/aws/install-language-runtime/">Install Language Runtime</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Configure AWS" href="/docs/quickstart/aws/configure/">Configure AWS</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Create a New Project" href="/docs/quickstart/aws/create-project/">Create a New Project</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Review the New Project" href="/docs/quickstart/aws/review-project/">Review the New Project</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Deploy the Stack" href="/docs/quickstart/aws/deploy-stack/">Deploy the Stack</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Modify the Program" href="/docs/quickstart/aws/modify-program/">Modify the Program</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Deploy the Changes" href="/docs/quickstart/aws/deploy-changes/">Deploy the Changes</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Destroy the Stack" href="/docs/quickstart/aws/destroy-stack/">Destroy the Stack</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Next Steps" href="/docs/quickstart/aws/next-steps/">Next Steps</a>
            </div>
        
    

                            </div>
                        
                    </div>
                </div>
            </div>
        
            
            

            

            <div class="toggleVisible separator">
                <div class="toggle" data-title="Azure">
                    <div class="collapsed">
                        <div class="sidenav-topic ">
                            <a data-title="Azure" href="/docs/quickstart/azure/">Azure</a><span class="toggleButton">
                                    <i class="fas fa-caret-right"></i>
                                </span></div>
                    </div>
                    <div class="expanded">
                        <div class="sidenav-topic  sidenav-parent  ">
                            <a data-title="Azure" href="/docs/quickstart/azure/">Azure</a><span class="toggleButton">
                                    <i class="fas fa-caret-down"></i>
                                </span></div>
                        
                            <div class="sidenav-subsection text-sm">
                                
    
    

    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Install Pulumi" href="/docs/quickstart/azure/install-pulumi/">Install Pulumi</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Install Language Runtime" href="/docs/quickstart/azure/install-language-runtime/">Install Language Runtime</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Configure Azure" href="/docs/quickstart/azure/configure/">Configure Azure</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Create a New Project" href="/docs/quickstart/azure/create-project/">Create a New Project</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Review the New Project" href="/docs/quickstart/azure/review-project/">Review the New Project</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Deploy the Stack" href="/docs/quickstart/azure/deploy-stack/">Deploy the Stack</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Modify the Program" href="/docs/quickstart/azure/modify-program/">Modify the Program</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Deploy the Changes" href="/docs/quickstart/azure/deploy-changes/">Deploy the Changes</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Destroy the Stack" href="/docs/quickstart/azure/destroy-stack/">Destroy the Stack</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Next Steps" href="/docs/quickstart/azure/next-steps/">Next Steps</a>
            </div>
        
    

                            </div>
                        
                    </div>
                </div>
            </div>
        
            
            

            

            <div class="toggleVisible separator">
                <div class="toggle" data-title="Google Cloud">
                    <div class="collapsed">
                        <div class="sidenav-topic ">
                            <a data-title="Google Cloud" href="/docs/quickstart/gcp/">Google Cloud</a><span class="toggleButton">
                                    <i class="fas fa-caret-right"></i>
                                </span></div>
                    </div>
                    <div class="expanded">
                        <div class="sidenav-topic  sidenav-parent  ">
                            <a data-title="Google Cloud" href="/docs/quickstart/gcp/">Google Cloud</a><span class="toggleButton">
                                    <i class="fas fa-caret-down"></i>
                                </span></div>
                        
                            <div class="sidenav-subsection text-sm">
                                
    
    

    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Install Pulumi" href="/docs/quickstart/gcp/install-pulumi/">Install Pulumi</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Install Language Runtime" href="/docs/quickstart/gcp/install-language-runtime/">Install Language Runtime</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Configure Google Cloud" href="/docs/quickstart/gcp/configure/">Configure Google Cloud</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Create a New Project" href="/docs/quickstart/gcp/create-project/">Create a New Project</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Review the New Project" href="/docs/quickstart/gcp/review-project/">Review the New Project</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Deploy the Stack" href="/docs/quickstart/gcp/deploy-stack/">Deploy the Stack</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Modify the Program" href="/docs/quickstart/gcp/modify-program/">Modify the Program</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Deploy the Changes" href="/docs/quickstart/gcp/deploy-changes/">Deploy the Changes</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Destroy the Stack" href="/docs/quickstart/gcp/destroy-stack/">Destroy the Stack</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Next Steps" href="/docs/quickstart/gcp/next-steps/">Next Steps</a>
            </div>
        
    

                            </div>
                        
                    </div>
                </div>
            </div>
        
            
            

            

            <div class="toggleVisible">
                <div class="toggle" data-title="Kubernetes">
                    <div class="collapsed">
                        <div class="sidenav-topic ">
                            <a data-title="Kubernetes" href="/docs/quickstart/kubernetes/">Kubernetes</a><span class="toggleButton">
                                    <i class="fas fa-caret-right"></i>
                                </span></div>
                    </div>
                    <div class="expanded">
                        <div class="sidenav-topic  sidenav-parent  ">
                            <a data-title="Kubernetes" href="/docs/quickstart/kubernetes/">Kubernetes</a><span class="toggleButton">
                                    <i class="fas fa-caret-down"></i>
                                </span></div>
                        
                            <div class="sidenav-subsection text-sm">
                                
    
    

    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Install Pulumi" href="/docs/quickstart/kubernetes/install-pulumi/">Install Pulumi</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Install Language Runtime" href="/docs/quickstart/kubernetes/install-language-runtime/">Install Language Runtime</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Configure Kubernetes" href="/docs/quickstart/kubernetes/configure/">Configure Kubernetes</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Create a New Project" href="/docs/quickstart/kubernetes/create-project/">Create a New Project</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Review the New Project" href="/docs/quickstart/kubernetes/review-project/">Review the New Project</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Deploy the Stack" href="/docs/quickstart/kubernetes/deploy-stack/">Deploy the Stack</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Modify the Program" href="/docs/quickstart/kubernetes/modify-program/">Modify the Program</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Deploy the Changes" href="/docs/quickstart/kubernetes/deploy-changes/">Deploy the Changes</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Destroy the Stack" href="/docs/quickstart/kubernetes/destroy-stack/">Destroy the Stack</a>
            </div>
        
    
        
        

        
            <div class="sidenav-topic mb-2 ">
                <a data-title="Next Steps" href="/docs/quickstart/kubernetes/next-steps/">Next Steps</a>
            </div>
        
    

                            </div>
                        
                    </div>
                </div>
            </div>
        

    

    
        <h4 class="no-anchor">
            <a href="/docs/reference/">Reference</a>
        </h4>
    
</aside>



            </div>

            <div class="md:w-7/12">
                <h1>Provisioning a Kubernetes Application</h1>
                

<p>This lab assumes you have successfully completed <a href="/docs/quickstart/k8s-the-prod-way/identity/">lab 1</a>, and <a href="/docs/quickstart/k8s-the-prod-way/infrastructure/">lab
2</a> the results of which are to have (1) successfully bootstrapped the
identity platform for CI/CD and teams, and (2) successfully created the Kubernetes cluster on which
we will deploy.</p>

<p>In this tutorial, we will use this identity to:</p>

<ul>
<li>Use the identity provisioned in lab 1 and the Kubernetes cluster provisioned in lab 2 to provision
a Kubernetes app, Wordpress.</li>
</ul>

<p>Inside the <a href="/docs/quickstart/k8s-the-prod-way/">Kubernetes the Prod Way repository</a>, the <code>services</code> directory contains the
Wordpress application and a collection of utility scripts for interacting with it.</p>

<h2 id="modeling-kubernetes-applications-with-code">Modeling Kubernetes Applications with code</h2>

<p>In the previous examples, we&rsquo;ve used Pulumi&rsquo;s TypeScript SDK to define GCP resources for identity
and shared, managed infrastructure.</p>

<p>This example does the same thing, but defines a Kubernetes application. Typically this application
would be managed through CI/CD, using a GCP service account running with permissions defined in the
identity stack, and the kubeconfig file defined in the infrastructure stack &ndash; we&rsquo;ll hook that up
later.</p>

<p>The Pulumi Kubernetes SDK is much like the GCP SDK, in that it is a direct projection of the
Kubernetes API, as defined by the official OpenAPI specification. Also like GCP, users create and
manage Kubernetes resources using classes. But, because the Pulumi SDK is written in a Turing
Complete language, we can also define higher-level libraries for constructs like Helm Charts.</p>

<p>Looking inside <a href="https://github.com/pulumi/kubernetes-the-prod-way/blob/master/services/wordpress/index.ts">services/wordpress/index.ts</a>, we can see code like the following, which is
using the Helm library to define Kubernetes resources.</p>
<div class="highlight"><pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="kr">const</span> <span class="nx">wordpress</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">k8s</span><span class="p">.</span><span class="nx">helm</span><span class="p">.</span><span class="nx">v2</span><span class="p">.</span><span class="nx">Chart</span><span class="p">(</span>
    <span class="s2">&#34;wpdev&#34;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="nx">repo</span><span class="o">:</span> <span class="s2">&#34;stable&#34;</span><span class="p">,</span>
        <span class="nx">version</span><span class="o">:</span> <span class="s2">&#34;2.1.3&#34;</span><span class="p">,</span>
        <span class="nx">chart</span><span class="o">:</span> <span class="s2">&#34;wordpress&#34;</span>
    <span class="p">},</span>
    <span class="p">{</span> <span class="nx">providers</span><span class="o">:</span> <span class="p">{</span> <span class="nx">kubernetes</span>: <span class="kt">config.k8sProvider</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">);</span></code></pre></div>
<h2 id="prerequisites-logging-into-cloud-provider-with-cli">Prerequisites: Logging into cloud provider with CLI</h2>

<p>In the first lab, we need to set up credentials using the CLI, so that Pulumi can authenticate
against the cloud provider of your choice. Make sure you&rsquo;re still logged in before continuing.</p>

<h2 id="provisioning">Provisioning</h2>

<p>Begin by <code>cd</code>&lsquo;ing into the <code>services/wordpress</code> directory. From there, install the Pulumi toolchain:</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">yarn install</code></pre></div>
<p>Like the second lab, the infrastructure stack comes with a script that will allow you to
authenticate using the CI/CD service account we defined in lab 1. This time, we will use the
Kubernetes application developer service account instead of the infrastructure admin account. As in
lab 2, we will later we will use this in CI/CD &ndash; for now we will use it to provision the Kubernetes
application.</p>

<p>Assuming you have successfully finished lab 1, you&rsquo;ll need to specify the name of the identity stack
you&rsquo;ve created. This was the argument you passed to <code>pulumi stack init</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">./scripts/login-to-ci-service-account.sh &lt;identity-stack-name&gt;</code></pre></div>
<p>As it did in lab 2, this script obtains the client secret for that service account from the identity
stack, and uses <code>gcloud</code> to authenticate with it.</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">pulumi stack output k8sAppDevCiClientSecret -s <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> &gt; k8s-app-dev-ci-client-secret.json
gcloud auth activate-service-account --key-file k8s-app-dev-ci-client-secret.json
rm k8s-app-dev-ci-client-secret.json</code></pre></div>
<p>Similar to what we did in lab 2, we need to specify the name of the infrastructure stack (<em>not</em> the
identity stack) so that this stack can configure itself to use the same project, zone, <em>etc</em>., and
so that it can retrieve the kubeconfig file.</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">pulumi stack init
pulumi config <span class="nb">set</span> infrastructureStackName &lt;infrastructure-stack-name&gt;
pulumi up</code></pre></div>
<p>On success, this should look something like the following.</p>

<p><img src="/images/docs/k8s-the-prod-way/app.png"></p>

<p>As we can see, we&rsquo;ve deployed a <code>Deployment</code> containing the WordPress application, along with a
<code>StatefulSet</code> for mariadb, <code>Secret</code>s for the passwords, and some <code>Pod</code>s that do end-to-end tests.</p>

<p>Looking inside the application file, we see:</p>
<div class="highlight"><pre class="chroma"><code class="language-typescript" data-lang="typescript"></code></pre></div>
<h2 id="stack-outputs-frontend-ip">Stack Outputs: Frontend IP</h2>

<p>Much like labs 1 and 2, this stack produces output values that can be referenced in other stacks. If
we run <code>pulumi stack output</code>, we see one export value:</p>

<ul>
<li><code>frontendIp</code>, public IP address allocated to Wordpress.</li>
</ul>

<p>If you paste this IP address into a browser, it should take you to the Wordpress landing page.</p>

<h2 id="next-steps">Next Steps</h2>

<p>In the next lab, we will see how to use the identities defined in lab 1 to set up CI for all of
these stacks.</p>

            </div>
        </div>
    </div>

        </main>

        <nav class="footer bg-purple-700 py-8 px-8 md:px-0">
    <div class="container mx-auto">
        <footer>
            <div class="md:flex items-top justify-between flex-wrap">

                <div class="mb-6 md:w-4/12">
                    <a class="block mt-2" href="/">
                        <img class="h-10 opacity-50" src="/images/logo/logo-white.svg" alt="Pulumi logo">
                    </a>
                    <a class="inline-block my-4 opacity-50 text-white text-lg" href="mailto:team@pulumi.com">team@pulumi.com</a>
                    <ul class="flex inline-items text-blue-300 text-2xl">
                        <li class="mr-4"><a class="hover:text-blue-200" href="https://twitter.com/pulumicorp" target="_blank"><i class="fab fa-twitter"></i></a></li>
                        <li class="mr-4"><a class="hover:text-blue-200" href="https://www.linkedin.com/company/pulumi/" target="_blank"><i class="fab fa-linkedin"></i></a></li>
                        <li class="mr-4"><a class="hover:text-blue-200" href="https://github.com/pulumi/" target="_blank"><i class="fab fa-github"></i></a></li>
                        <li class="mr-4"><a class="hover:text-blue-200" href="https://www.youtube.com/channel/UC2Dhyn4Ev52YSbcpfnfP0Mw" target="_blank"><i class="fab fa-youtube"></i></a></li>
                        <li><a class="hover:text-blue-200" href="https://slack.pulumi.io/" target="_blank"><i class="fab fa-slack-hash"></i></a></li>
                    </ul>
                </div>

                <div class="flex flex-wrap items-top md:w-8/12">
                    <ul class="my-4 text-white w-1/2 md:w-3/12">
                        <li class="mb-4"><a href="/containers/">Containers</a></li>
                        <li class="mb-4"><a href="/serverless/">Serverless</a></li>
                        <li class="mb-4"><a href="/docs/reference/tutorials/aws/tutorial-ec2-webserver/">Infrastructure</a></li>
                        <li class="mb-4"><a href="/kubernetes/">Kubernetes</a></li>
                    </ul>
                    <ul class="my-4 text-white w-1/2 md:w-3/12">
                        <li class="mb-4"><a href="/docs/reference/install/">Install</a></li>
                        <li class="mb-4"><a href="/docs/quickstart/">Get Started</a></li>
                        <li class="mb-4"><a href="/docs/reference/">Documentation</a></li>
                        <li class="mb-4"><a href="/docs/reference/pkg/">APIs</a></li>
                    </ul>
                    <ul class="my-4 text-white w-1/2 md:w-3/12">
                        <li class="mb-4"><a href="/docs/quickstart/aws/">AWS</a></li>
                        <li class="mb-4"><a href="/docs/quickstart/azure/">Azure</a></li>
                        <li class="mb-4"><a href="/docs/quickstart/gcp/">Google Cloud</a></li>
                        <li class="mb-4"><a href="/docs/quickstart/kubernetes/">Kubernetes</a></li>
                        <li class="mb-4"><a href="/docs/quickstart/cloudfx/">Cloud Framework</a></li>
                        <li class="mb-4"><a href="/docs/reference/clouds/openstack/">OpenStack</a></li>
                    </ul>
                    <ul class="my-4 text-white w-1/2 md:w-3/12">
                        <li class="mb-4"><a href="/about/">About Us</a></li>
                        <li class="mb-4"><a href="/contact/">Contact Us</a></li>
                        <li class="mb-4"><a href="/support/">Support</a></li>
                        <li class="mb-4"><a href="/careers/">Careers</a></li>
                    </ul>
                </div>
            </div>

            <div class="text-white opacity-75 text-sm lg:flex items-center border-t border-purple-500 mt-4 pt-4">
                
                <p class="md:w-4/12">&copy; 2019 Pulumi. All rights reserved.</p>

                <ul class="md:w-8/12">
                    
                        <li class="inline mr-2 lg:mr-4"><a href="/trademark/">Trademark Usage</a></li>
                    
                        <li class="inline mr-2 lg:mr-4"><a href="/acceptable-use/">Acceptable Use Policy</a></li>
                    
                        <li class="inline mr-2 lg:mr-4"><a href="/terms-and-conditions/">Terms &amp; Conditions</a></li>
                    
                        <li class="inline mr-2 lg:mr-4"><a href="/privacy/">Privacy Policy</a></li>
                    
                        <li class="inline mr-2 lg:mr-4"><a href="/professional-services-agreement/">Professional Services Agreement</a></li>
                    
                </ul>
            </div>
        </footer>
    </div>
</nav>

        <script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>











    




<script src="/js/bundle.min.8d935315b94bf6e77843b9c51ebc10238af740294e751f49b183b5d1e27a1c27.js" integrity="sha256-jZNTFblL9ud4Q7nFHrwQI4r3QClOdR9JsYO10eJ6HCc="></script>

    </body>
</html>
